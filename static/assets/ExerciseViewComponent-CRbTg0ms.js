import{_ as W,m as I,l as b,c as d,d as h,t as p,a as M,F as g,A as m,D as L,T,C as S,y as C,u as y,o as c,w as x,v,g as w,n as f,k as A,q as k,p as E,E as q}from"./index-Bx-6Qppa.js";const O={beforeMount(){(!this.progress.words||!Array.isArray(this.progress.words))&&(this.open=Array.from({length:this.progress.words?.length},()=>!1))},computed:{...b(y,["exercises"]),exercise(){return this.getExercise(this.unitId,this.exerciseId)},whoSOpen(){return this.open.findIndex(t=>t)},progress(){return{words:this.getExerciseProgress(this.unitId,this.exerciseId)?.progress}},toShow(){const t=this.exercises[this.unitId].findIndex(e=>e.id===this.exerciseId);return this.exercises[this.unitId][t].toShow}},data(){return{showWAAlert:!1,timeoutId:null,open:[]}},methods:{...I(y,["getExercise","getExerciseProgress","wordScrambleOperation"]),async checkAnswer(t){if(this.progress.words[t].unplaced.length===0)try{const{data:e,status:o}=await S.checkAnswer(await C(),this.exercise.type,this.exercise.id,{index:t+1,word:this.progress.words[t].placed.join("")}),{msg:n,solved:r}=e;n==="wrong answer"?this.wrongAnswer():r&&(this.wordScrambleOperation(this.unitId,this.exerciseId,"solve",t),this.open[t]=!1)}catch(e){console.error(e)}},closeOpen(t){this.open[t]=!1,this.showWAAlert=!1,clearTimeout(this.timeoutId)},wrongAnswer(){this.showWAAlert=!0,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.showWAAlert=!1},2500)}},name:"WordScrambleComponent",props:{exerciseId:{type:String,required:!0},type:{type:String,required:!0},unitId:{type:String,required:!0}}},D={class:"word-scramble-frame"},P={class:"thematic"},z={class:"word-container"},H=["onClick"],R=["onClick"],B={class:"placement-container"},F=["onClick"],V=["onClick"],$={class:"letters-container"},N=["onClick"],G={key:0,class:"wa-alert"};function U(t,e,o,n,r,i){return c(),d("div",D,[h("h3",P,"Thematic: "+p(i.exercise?.thematic),1),e[0]||(e[0]=h("h6",{class:"order"},"Unscramble this words",-1)),h("div",z,[(c(!0),d(g,null,m(i.progress.words||[],(s,l)=>x((c(),d("div",{key:l,class:f(["word",{open:r.open[l]}]),onClick:w(a=>r.open[l]=!s.solved,["stop"])},[x(h("p",{class:f(["full",{solved:s.solved}])},p(i.toShow[l].join("")),3),[[v,!r.open[l]]]),x(h("span",{class:"btn back-btn material-symbols-rounded",onClick:w(a=>i.closeOpen(l),["stop"])}," close ",8,R),[[v,r.open[l]]]),x(h("div",B,[(c(!0),d(g,null,m(s.placed,(a,u)=>(c(),d("div",{key:u,class:f(["letter_place",{hasLetter:a!="_"}]),onClick:w(_=>a!="_"?t.wordScrambleOperation(o.unitId,o.exerciseId,"unplaceLetter",l,u):null,["stop"])},p(a),11,F))),128)),h("span",{class:f(["btn send_btn material-symbols-rounded",{disabled:s.unplaced.length!==0}]),onClick:w(a=>i.checkAnswer(l),["stop"])}," send ",10,V)],512),[[v,r.open[l]]]),x(h("div",$,[(c(!0),d(g,null,m(s.unplaced,(a,u)=>(c(),d("div",{key:u,class:"letter",onClick:w(_=>t.wordScrambleOperation(o.unitId,o.exerciseId,"placeLetter",l,u),["stop"])},p(a),9,N))),128))],512),[[v,r.open[l]]])],10,H)),[[v,i.whoSOpen===-1||i.whoSOpen===l]])),128)),M(T,{name:"alert-fade"},{default:L(()=>[r.showWAAlert?(c(),d("div",G," ❌ Wrong answer ❌ ")):A("",!0)]),_:1})])])}const j=W(O,[["render",U],["__scopeId","data-v-08e2aa5f"]]),J={beforeUnmount(){window.removeEventListener("resize",this.windowResize)},computed:{exercise(){return this.getExercise(this.unitId,this.exerciseId)},findedWords(){return this.progress?.words.filter(t=>t.solved)},progress(){return this.getExerciseProgress(this.unitId,this.exerciseId)?.progress},selectionatorStyles(){if(!this.selection)return;const t=this.selection.x-(this.cellClicked.x+this.cellWidth/2),e=this.selection.y-(this.cellClicked.y+this.cellWidth/2),o=Math.atan2(-e,t)*(180/Math.PI),n=Math.sqrt(t*t+e*e);return{"--calculatedAngle":`${o}deg`,"--calculatedHeight":`${n+this.cellWidth}px`,"--calculatedLeft":`${this.cellClicked.y}px`,"--calculatedTop":`${this.cellClicked.x}px`,"--calculatedCornerRadius":`${this.cellWidth/2}px`}}},data(){return{cellClicked:{x:null,y:null},cellHovered:{x:null,y:null},cellWidth:0,selection:null,showWAAlert:!1,timeoutId:null}},methods:{...I(y,["getExercise","getExerciseProgress","wordSearchOperation"]),async checkAnswer(t,e){if(this.findedWords.some(s=>s.start[0]===t[0]&&s.start[1]===t[1]&&s.end[0]===e[0]&&s.end[1]===e[1])||t[0]===e[0]&&t[1]===e[1])return;const o=t[0]!==e[0]&&t[1]===e[1],n=t[0]===e[0]&&t[1]!==e[1],r=t[0]-e[0]===t[1]-e[1],i=-(t[0]-e[0])===t[1]-e[1];if(!(!o&&!n&&!r&&!i))try{const{data:s,status:l}=await S.checkAnswer(await C(),this.exercise.type,this.exercise.id,{start:t,end:e}),{msg:a,solved:u,exerciseCompleted:_}=s;a==="wrong answer"?this.wrongAnswer():u&&this.wordSearchOperation(this.unitId,this.exerciseId,t,e)}catch(s){console.error(s)}},diagonalLength(t){return Math.sqrt(this.cellWidth*this.cellWidth+this.cellWidth*this.cellWidth)*t-this.cellWidth},endSelection({layerX:t,layerY:e}){this.checkAnswer([Math.floor(this.cellClicked.x/this.cellWidth),Math.floor(this.cellClicked.y/this.cellWidth)],[Math.floor(e/this.cellWidth),Math.floor(t/this.cellWidth)]),this.selection=null,this.cellClicked={x:null,y:null}},findedWordStyles({end:t,start:e}){const o=e[0]-t[0],n=e[1]-t[1];let r,i=this.cellWidth*e[1],s,l=this.cellWidth*e[0];return o<0?n<0?(r=-45,s=this.diagonalLength(-n+1)):n===0?(r=0,s=(-o+1)*this.cellWidth):(r=45,s=this.diagonalLength(n+1)):o===0?n<0?(r=-90,s=(-n+1)*this.cellWidth):(r=90,s=(n+1)*this.cellWidth):n<0?(r=-135,s=(o+1)*this.cellWidth):n===0?(r=180,s=(o+1)*this.cellWidth):(r=135,s=this.diagonalLength(n+1)),{"--calculatedAngle":`${r}deg`,"--calculatedHeight":`${s}px`,"--calculatedLeft":`${i}px`,"--calculatedTop":`${l}px`,"--calculatedCornerRadius":`${this.cellWidth/2}px`}},hoverSetter({layerX:t,layerY:e}){this.cellHovered={x:Math.floor(e/this.cellWidth),y:Math.floor(t/this.cellWidth)},this.selection&&(this.selection={x:e,y:t})},leavingPool(){this.cellClicked=this.cellHovered={x:null,y:null},this.selection=null},startSelection({layerX:t,layerY:e}){this.selection={x:e,y:t},this.cellClicked={x:Math.floor(e/this.cellWidth)*this.cellWidth,y:Math.floor(t/this.cellWidth)*this.cellWidth}},windowResize(){this.cellWidth=this.$refs?.poolContainer?.offsetWidth/10},wrongAnswer(){this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.timeoutId=setTimeout(()=>{this.timeoutId=null},1e3)}},mounted(){window.addEventListener("resize",this.windowResize)},name:"WordSearchComponent",props:{exerciseId:{type:String,required:!0},type:{type:String,required:!0},unitId:{type:String,required:!0}},watch:{progress:{handler(){this.$nextTick(()=>{this.cellWidth=this.$refs?.poolContainer?.offsetWidth/10})},immediate:!0}}},K={class:"word-search-frame"},Q={class:"thematic"},X={class:"letter"},Y={class:"finded-words-container"},Z={class:"words-container"};function ee(t,e,o,n,r,i){return c(),d("div",K,[h("h3",Q,"Thematic: "+p(i.exercise?.thematic),1),e[4]||(e[4]=h("h6",{class:"order"},"Find these words in the pool",-1)),h("div",{ref:"poolContainer",class:f(["pool-container",{animated:r.timeoutId!==null}])},[(c(!0),d(g,null,m(i.progress?.letterPool||[],(s,l)=>(c(),d("div",{key:l,class:"row-container"},[(c(!0),d(g,null,m(s,(a,u)=>(c(),d("div",{key:u,class:f(["col",{"vue-hover":l===this.cellHovered.x&&u===this.cellHovered.y}])},[h("p",X,p(a),1)],2))),128))]))),128)),h("div",Y,[(c(!0),d(g,null,m(i.findedWords,(s,l)=>(c(),d("div",{key:l,class:"finded-word",style:k(i.findedWordStyles(s))},null,4))),128)),this.selection!==null?(c(),d("div",{key:0,class:"selectionator",style:k(i.selectionatorStyles)},null,4)):A("",!0)]),h("div",{ref:"eventsGetter",onMousemove:e[0]||(e[0]=w((...s)=>i.hoverSetter&&i.hoverSetter(...s),["stop"])),onMousedown:e[1]||(e[1]=(...s)=>i.startSelection&&i.startSelection(...s)),onMouseup:e[2]||(e[2]=(...s)=>i.endSelection&&i.endSelection(...s)),onMouseleave:e[3]||(e[3]=(...s)=>i.leavingPool&&i.leavingPool(...s)),class:"eventsGetter"},null,544)],2),h("div",Z,[(c(!0),d(g,null,m(i.progress?.words,(s,l)=>(c(),d("p",{key:l,class:f(["word",{solved:s.solved}])},p(s.word),3))),128))])])}const te=W(J,[["render",ee],["__scopeId","data-v-e6ef7285"]]),se={computed:{exerciseComponent(){switch(this.type){case"FillBlank":console.log(this.type);break;case"Match":console.log(this.type);break;case"PicsToWord":console.log(this.type);break;case"WordScramble":return j;case"WordSearch":return te;default:this.$router.clearRoutes(),this.$router.push({name:"home"})}}},methods:{},props:{exerciseId:{type:String,required:!0},type:{type:String,required:!0},unitId:{type:String,required:!0}}};function ie(t,e,o,n,r,i){return c(),E(q(i.exerciseComponent),{exerciseId:o.exerciseId,type:o.type,unitId:o.unitId},null,8,["exerciseId","type","unitId"])}const le=W(se,[["render",ie]]);export{le as default};
